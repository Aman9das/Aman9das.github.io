{
  "hash": "7fa1a9a321143c03c8b0bddab5ea0f20",
  "result": {
    "markdown": "---\ntitle: Semester 2 Midsem Project\nsubtitle: Multivariate Analysis on Foreign Tourist Visits to India\nauthor:\n  - Aman Das [BS2206]\n  - Raj Pratap Singh [BS2219]\n  - Shreyansh Mukhopadhyay [BS2147]\nimage: index_files/figure-html/unnamed-chunk-13-1.png\ndate: \"2023-5-7\"\ndate-format: long\nformat: html\nexecute:\n  warning: false\n  error: false\ncategories: [project, statistics]\naliases: \n  - main.html\n---\n\n\n\n\n# Introduction\n\n## Aim\n\nOur Aim is to do conduct an exploratory data analysis on Number of Foreign Tourist Arrivals in India over a period of 2000-2019 by attempting to obtain suitable predictors and identify causal relations through fitting the data to Multiple Linear Regression Models (MLR).\n\n## Variables\n\nAlong with the response variable Number of Foreign Tourist Arrivals in India, we have 14 other covariates as our predictor variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescription = as.data.frame(t(read.csv(file.path(\".\",\"data\",\"FOREIGNTOURISTSeries.csv\"), fileEncoding = 'UTF-8-BOM')[c(1, 2, 5, 6),]))\nnames(description) = description[1,]\ndescription = description[-1,]\nkable(description)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:left;\"> Variable </th>\n   <th style=\"text-align:left;\"> Region </th>\n   <th style=\"text-align:left;\"> Unit </th>\n   <th style=\"text-align:left;\"> Source </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> indfortour </td>\n   <td style=\"text-align:left;\"> Foreign Tourist Arrivals: Total </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> Person </td>\n   <td style=\"text-align:left;\"> Ministry of Tourism </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> intpop </td>\n   <td style=\"text-align:left;\"> Population: Total </td>\n   <td style=\"text-align:left;\"> World </td>\n   <td style=\"text-align:left;\"> Person </td>\n   <td style=\"text-align:left;\"> World Bank </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> intfortour </td>\n   <td style=\"text-align:left;\"> International Tourism: Number of Arrivals </td>\n   <td style=\"text-align:left;\"> World </td>\n   <td style=\"text-align:left;\"> Person </td>\n   <td style=\"text-align:left;\"> World Bank </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hotelrev </td>\n   <td style=\"text-align:left;\"> NAS 2011-2012: Gross Value Added: 2011-2012p: Services: Trade, Repair, Hotel and Restaurant: Hotels and Restaurants </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> INR mn </td>\n   <td style=\"text-align:left;\"> Ministry of Statistics and Programme Implementation </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indpop </td>\n   <td style=\"text-align:left;\"> Population </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> Person mn </td>\n   <td style=\"text-align:left;\"> Ministry of Statistics and Programme Implementation </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indexport </td>\n   <td style=\"text-align:left;\"> Exports: Annual: USD </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> USD mn </td>\n   <td style=\"text-align:left;\"> Reserve Bank of India </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indimport </td>\n   <td style=\"text-align:left;\"> Imports: Annual: USD </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> USD mn </td>\n   <td style=\"text-align:left;\"> Reserve Bank of India </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indforinv </td>\n   <td style=\"text-align:left;\"> Foreign Investment Inflows </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> USD mn </td>\n   <td style=\"text-align:left;\"> Reserve Bank of India </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indforres </td>\n   <td style=\"text-align:left;\"> Foreign Exchange Reserve: Annual </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> INR mn </td>\n   <td style=\"text-align:left;\"> Reserve Bank of India </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indpastra </td>\n   <td style=\"text-align:left;\"> Passenger Traffic: International: To India </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> Person </td>\n   <td style=\"text-align:left;\"> Directorate General of Civil Aviation </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> stattourexp </td>\n   <td style=\"text-align:left;\"> All States: Capital Expenditure: Outlay: Developmental: Economic Services: General: Tourism </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> INR mn </td>\n   <td style=\"text-align:left;\"> Reserve Bank of India </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indtourexp </td>\n   <td style=\"text-align:left;\"> Union Budget: Expenditure: Ministry of Tourism </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> INR mn </td>\n   <td style=\"text-align:left;\"> Ministry of Finance </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indcrim </td>\n   <td style=\"text-align:left;\"> IPC Crime: Incidence Rate </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> % </td>\n   <td style=\"text-align:left;\"> National Crime Records Bureau </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> inddep </td>\n   <td style=\"text-align:left;\"> Indian National Departures </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> Person </td>\n   <td style=\"text-align:left;\"> Ministry of Tourism </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> forbankprof </td>\n   <td style=\"text-align:left;\"> Foreign Banks: Operating Profit </td>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:left;\"> INR mn </td>\n   <td style=\"text-align:left;\"> Reserve Bank of India </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Data\n\n::: column-screen-inset\n\n::: {.cell}\n\n```{.r .cell-code}\nd = read.csv(file.path(\".\",\"data\",\"tourist_data.csv\"), colClasses = \"numeric\", fileEncoding = 'UTF-8-BOM')\n\nfor (x in colnames(d)) {\n  d[, x ] = as.numeric(d[, x ])\n}\nd = data.frame(d)\nkable(d)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> year </th>\n   <th style=\"text-align:right;\"> indfortour </th>\n   <th style=\"text-align:right;\"> intpop </th>\n   <th style=\"text-align:right;\"> intfortour </th>\n   <th style=\"text-align:right;\"> hotelrev </th>\n   <th style=\"text-align:right;\"> indpop </th>\n   <th style=\"text-align:right;\"> indexport </th>\n   <th style=\"text-align:right;\"> indimport </th>\n   <th style=\"text-align:right;\"> indforinv </th>\n   <th style=\"text-align:right;\"> indforres </th>\n   <th style=\"text-align:right;\"> indpastra </th>\n   <th style=\"text-align:right;\"> stattourexp </th>\n   <th style=\"text-align:right;\"> indtourexp </th>\n   <th style=\"text-align:right;\"> indcrim </th>\n   <th style=\"text-align:right;\"> inddep </th>\n   <th style=\"text-align:right;\"> forbankprof </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 2638813 </td>\n   <td style=\"text-align:right;\"> 6144322697 </td>\n   <td style=\"text-align:right;\"> 1332379079 </td>\n   <td style=\"text-align:right;\"> 364920.6 </td>\n   <td style=\"text-align:right;\"> 1001 </td>\n   <td style=\"text-align:right;\"> 36822.4 </td>\n   <td style=\"text-align:right;\"> 49670.7 </td>\n   <td style=\"text-align:right;\"> 5181 </td>\n   <td style=\"text-align:right;\"> 1659130 </td>\n   <td style=\"text-align:right;\"> 5886514 </td>\n   <td style=\"text-align:right;\"> 712.50 </td>\n   <td style=\"text-align:right;\"> 1323.4 </td>\n   <td style=\"text-align:right;\"> 176.7 </td>\n   <td style=\"text-align:right;\"> 3117974 </td>\n   <td style=\"text-align:right;\"> 27536.70 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2001 </td>\n   <td style=\"text-align:right;\"> 2537282 </td>\n   <td style=\"text-align:right;\"> 6226339538 </td>\n   <td style=\"text-align:right;\"> 1299004508 </td>\n   <td style=\"text-align:right;\"> 390347.7 </td>\n   <td style=\"text-align:right;\"> 1019 </td>\n   <td style=\"text-align:right;\"> 44560.3 </td>\n   <td style=\"text-align:right;\"> 50536.5 </td>\n   <td style=\"text-align:right;\"> 5860 </td>\n   <td style=\"text-align:right;\"> 1972040 </td>\n   <td style=\"text-align:right;\"> 6018591 </td>\n   <td style=\"text-align:right;\"> 524.70 </td>\n   <td style=\"text-align:right;\"> 1500.8 </td>\n   <td style=\"text-align:right;\"> 172.3 </td>\n   <td style=\"text-align:right;\"> 3579052 </td>\n   <td style=\"text-align:right;\"> 31051.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2002 </td>\n   <td style=\"text-align:right;\"> 2384364 </td>\n   <td style=\"text-align:right;\"> 6308092739 </td>\n   <td style=\"text-align:right;\"> 1319581840 </td>\n   <td style=\"text-align:right;\"> 420988.5 </td>\n   <td style=\"text-align:right;\"> 1040 </td>\n   <td style=\"text-align:right;\"> 43826.7 </td>\n   <td style=\"text-align:right;\"> 51413.3 </td>\n   <td style=\"text-align:right;\"> 8151 </td>\n   <td style=\"text-align:right;\"> 2640360 </td>\n   <td style=\"text-align:right;\"> 5830289 </td>\n   <td style=\"text-align:right;\"> 991.50 </td>\n   <td style=\"text-align:right;\"> 1746.3 </td>\n   <td style=\"text-align:right;\"> 169.5 </td>\n   <td style=\"text-align:right;\"> 4123163 </td>\n   <td style=\"text-align:right;\"> 35130.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2003 </td>\n   <td style=\"text-align:right;\"> 2726214 </td>\n   <td style=\"text-align:right;\"> 6389383352 </td>\n   <td style=\"text-align:right;\"> 1300066793 </td>\n   <td style=\"text-align:right;\"> 445024.2 </td>\n   <td style=\"text-align:right;\"> 1056 </td>\n   <td style=\"text-align:right;\"> 52719.4 </td>\n   <td style=\"text-align:right;\"> 61412.1 </td>\n   <td style=\"text-align:right;\"> 6014 </td>\n   <td style=\"text-align:right;\"> 3614700 </td>\n   <td style=\"text-align:right;\"> 6373862 </td>\n   <td style=\"text-align:right;\"> 961.70 </td>\n   <td style=\"text-align:right;\"> 3018.9 </td>\n   <td style=\"text-align:right;\"> 160.7 </td>\n   <td style=\"text-align:right;\"> 4161575 </td>\n   <td style=\"text-align:right;\"> 37284.20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2004 </td>\n   <td style=\"text-align:right;\"> 3457477 </td>\n   <td style=\"text-align:right;\"> 6470821068 </td>\n   <td style=\"text-align:right;\"> 1436450364 </td>\n   <td style=\"text-align:right;\"> 483368.6 </td>\n   <td style=\"text-align:right;\"> 1072 </td>\n   <td style=\"text-align:right;\"> 63842.6 </td>\n   <td style=\"text-align:right;\"> 78149.1 </td>\n   <td style=\"text-align:right;\"> 15699 </td>\n   <td style=\"text-align:right;\"> 4901290 </td>\n   <td style=\"text-align:right;\"> 7040851 </td>\n   <td style=\"text-align:right;\"> 1245.70 </td>\n   <td style=\"text-align:right;\"> 4057.2 </td>\n   <td style=\"text-align:right;\"> 168.8 </td>\n   <td style=\"text-align:right;\"> 4955244 </td>\n   <td style=\"text-align:right;\"> 49874.50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2005 </td>\n   <td style=\"text-align:right;\"> 3918610 </td>\n   <td style=\"text-align:right;\"> 6552571570 </td>\n   <td style=\"text-align:right;\"> 1501611341 </td>\n   <td style=\"text-align:right;\"> 538520.8 </td>\n   <td style=\"text-align:right;\"> 1089 </td>\n   <td style=\"text-align:right;\"> 83535.9 </td>\n   <td style=\"text-align:right;\"> 111517.4 </td>\n   <td style=\"text-align:right;\"> 13103 </td>\n   <td style=\"text-align:right;\"> 6191160 </td>\n   <td style=\"text-align:right;\"> 8362204 </td>\n   <td style=\"text-align:right;\"> 2310.60 </td>\n   <td style=\"text-align:right;\"> 4991.2 </td>\n   <td style=\"text-align:right;\"> 165.3 </td>\n   <td style=\"text-align:right;\"> 4962309 </td>\n   <td style=\"text-align:right;\"> 45773.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2006 </td>\n   <td style=\"text-align:right;\"> 4447167 </td>\n   <td style=\"text-align:right;\"> 6634935638 </td>\n   <td style=\"text-align:right;\"> 1683029832 </td>\n   <td style=\"text-align:right;\"> 616003.4 </td>\n   <td style=\"text-align:right;\"> 1106 </td>\n   <td style=\"text-align:right;\"> 103090.5 </td>\n   <td style=\"text-align:right;\"> 149165.7 </td>\n   <td style=\"text-align:right;\"> 16261 </td>\n   <td style=\"text-align:right;\"> 6763870 </td>\n   <td style=\"text-align:right;\"> 9736531 </td>\n   <td style=\"text-align:right;\"> 3325.30 </td>\n   <td style=\"text-align:right;\"> 8002.7 </td>\n   <td style=\"text-align:right;\"> 167.7 </td>\n   <td style=\"text-align:right;\"> 6073303 </td>\n   <td style=\"text-align:right;\"> 66584.40 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2007 </td>\n   <td style=\"text-align:right;\"> 5081504 </td>\n   <td style=\"text-align:right;\"> 6717641730 </td>\n   <td style=\"text-align:right;\"> 1739388600 </td>\n   <td style=\"text-align:right;\"> 689938.8 </td>\n   <td style=\"text-align:right;\"> 1122 </td>\n   <td style=\"text-align:right;\"> 126414.1 </td>\n   <td style=\"text-align:right;\"> 185735.2 </td>\n   <td style=\"text-align:right;\"> 14640 </td>\n   <td style=\"text-align:right;\"> 8682220 </td>\n   <td style=\"text-align:right;\"> 13124178 </td>\n   <td style=\"text-align:right;\"> 4305.40 </td>\n   <td style=\"text-align:right;\"> 8343.2 </td>\n   <td style=\"text-align:right;\"> 175.1 </td>\n   <td style=\"text-align:right;\"> 7339375 </td>\n   <td style=\"text-align:right;\"> 96194.68 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2008 </td>\n   <td style=\"text-align:right;\"> 5282603 </td>\n   <td style=\"text-align:right;\"> 6801408360 </td>\n   <td style=\"text-align:right;\"> 1750746690 </td>\n   <td style=\"text-align:right;\"> 759225.4 </td>\n   <td style=\"text-align:right;\"> 1138 </td>\n   <td style=\"text-align:right;\"> 162904.2 </td>\n   <td style=\"text-align:right;\"> 251439.2 </td>\n   <td style=\"text-align:right;\"> 43325 </td>\n   <td style=\"text-align:right;\"> 12379650 </td>\n   <td style=\"text-align:right;\"> 14116845 </td>\n   <td style=\"text-align:right;\"> 4973.60 </td>\n   <td style=\"text-align:right;\"> 9906.9 </td>\n   <td style=\"text-align:right;\"> 181.5 </td>\n   <td style=\"text-align:right;\"> 6989719 </td>\n   <td style=\"text-align:right;\"> 140474.18 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2009 </td>\n   <td style=\"text-align:right;\"> 5167699 </td>\n   <td style=\"text-align:right;\"> 6885490816 </td>\n   <td style=\"text-align:right;\"> 1687198488 </td>\n   <td style=\"text-align:right;\"> 726308.3 </td>\n   <td style=\"text-align:right;\"> 1154 </td>\n   <td style=\"text-align:right;\"> 185295.0 </td>\n   <td style=\"text-align:right;\"> 303696.3 </td>\n   <td style=\"text-align:right;\"> 8311 </td>\n   <td style=\"text-align:right;\"> 12838650 </td>\n   <td style=\"text-align:right;\"> 14116845 </td>\n   <td style=\"text-align:right;\"> 6631.40 </td>\n   <td style=\"text-align:right;\"> 10294.1 </td>\n   <td style=\"text-align:right;\"> 181.4 </td>\n   <td style=\"text-align:right;\"> 6665865 </td>\n   <td style=\"text-align:right;\"> 200984.74 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2010 </td>\n   <td style=\"text-align:right;\"> 5775692 </td>\n   <td style=\"text-align:right;\"> 6969631901 </td>\n   <td style=\"text-align:right;\"> 1755720046 </td>\n   <td style=\"text-align:right;\"> 724247.9 </td>\n   <td style=\"text-align:right;\"> 1170 </td>\n   <td style=\"text-align:right;\"> 178751.4 </td>\n   <td style=\"text-align:right;\"> 288372.9 </td>\n   <td style=\"text-align:right;\"> 50361 </td>\n   <td style=\"text-align:right;\"> 12596650 </td>\n   <td style=\"text-align:right;\"> 15700668 </td>\n   <td style=\"text-align:right;\"> 7904.50 </td>\n   <td style=\"text-align:right;\"> 10029.7 </td>\n   <td style=\"text-align:right;\"> 187.6 </td>\n   <td style=\"text-align:right;\"> 8280194 </td>\n   <td style=\"text-align:right;\"> 163011.68 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2011 </td>\n   <td style=\"text-align:right;\"> 6309222 </td>\n   <td style=\"text-align:right;\"> 7053533350 </td>\n   <td style=\"text-align:right;\"> 1792688016 </td>\n   <td style=\"text-align:right;\"> 844334.2 </td>\n   <td style=\"text-align:right;\"> 1186 </td>\n   <td style=\"text-align:right;\"> 251136.2 </td>\n   <td style=\"text-align:right;\"> 369769.1 </td>\n   <td style=\"text-align:right;\"> 41597 </td>\n   <td style=\"text-align:right;\"> 13610130 </td>\n   <td style=\"text-align:right;\"> 17348027 </td>\n   <td style=\"text-align:right;\"> 7870.90 </td>\n   <td style=\"text-align:right;\"> 10545.3 </td>\n   <td style=\"text-align:right;\"> 192.2 </td>\n   <td style=\"text-align:right;\"> 9835221 </td>\n   <td style=\"text-align:right;\"> 163136.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2012 </td>\n   <td style=\"text-align:right;\"> 6577745 </td>\n   <td style=\"text-align:right;\"> 7140895722 </td>\n   <td style=\"text-align:right;\"> 1881196825 </td>\n   <td style=\"text-align:right;\"> 899008.3 </td>\n   <td style=\"text-align:right;\"> 1220 </td>\n   <td style=\"text-align:right;\"> 305963.9 </td>\n   <td style=\"text-align:right;\"> 489319.5 </td>\n   <td style=\"text-align:right;\"> 39032 </td>\n   <td style=\"text-align:right;\"> 15061390 </td>\n   <td style=\"text-align:right;\"> 18882428 </td>\n   <td style=\"text-align:right;\"> 11885.10 </td>\n   <td style=\"text-align:right;\"> 11140.9 </td>\n   <td style=\"text-align:right;\"> 196.7 </td>\n   <td style=\"text-align:right;\"> 10412854 </td>\n   <td style=\"text-align:right;\"> 185734.43 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2013 </td>\n   <td style=\"text-align:right;\"> 6967601 </td>\n   <td style=\"text-align:right;\"> 7229184551 </td>\n   <td style=\"text-align:right;\"> 1952484358 </td>\n   <td style=\"text-align:right;\"> 929550.0 </td>\n   <td style=\"text-align:right;\"> 1235 </td>\n   <td style=\"text-align:right;\"> 300400.6 </td>\n   <td style=\"text-align:right;\"> 490736.6 </td>\n   <td style=\"text-align:right;\"> 46708 </td>\n   <td style=\"text-align:right;\"> 15884200 </td>\n   <td style=\"text-align:right;\"> 19802245 </td>\n   <td style=\"text-align:right;\"> 13513.60 </td>\n   <td style=\"text-align:right;\"> 8369.1 </td>\n   <td style=\"text-align:right;\"> 215.5 </td>\n   <td style=\"text-align:right;\"> 10775570 </td>\n   <td style=\"text-align:right;\"> 204316.87 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2014 </td>\n   <td style=\"text-align:right;\"> 7679099 </td>\n   <td style=\"text-align:right;\"> 7317508753 </td>\n   <td style=\"text-align:right;\"> 2012330419 </td>\n   <td style=\"text-align:right;\"> 925650.0 </td>\n   <td style=\"text-align:right;\"> 1251 </td>\n   <td style=\"text-align:right;\"> 314415.7 </td>\n   <td style=\"text-align:right;\"> 450213.6 </td>\n   <td style=\"text-align:right;\"> 26385 </td>\n   <td style=\"text-align:right;\"> 18283800 </td>\n   <td style=\"text-align:right;\"> 21170370 </td>\n   <td style=\"text-align:right;\"> 16532.80 </td>\n   <td style=\"text-align:right;\"> 8864.4 </td>\n   <td style=\"text-align:right;\"> 229.2 </td>\n   <td style=\"text-align:right;\"> 11484956 </td>\n   <td style=\"text-align:right;\"> 227366.28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2015 </td>\n   <td style=\"text-align:right;\"> 8027133 </td>\n   <td style=\"text-align:right;\"> 7404910892 </td>\n   <td style=\"text-align:right;\"> 2071785910 </td>\n   <td style=\"text-align:right;\"> 982012.8 </td>\n   <td style=\"text-align:right;\"> 1267 </td>\n   <td style=\"text-align:right;\"> 310352.0 </td>\n   <td style=\"text-align:right;\"> 448033.4 </td>\n   <td style=\"text-align:right;\"> 73458 </td>\n   <td style=\"text-align:right;\"> 21376400 </td>\n   <td style=\"text-align:right;\"> 22438105 </td>\n   <td style=\"text-align:right;\"> 20350.40 </td>\n   <td style=\"text-align:right;\"> 9433.1 </td>\n   <td style=\"text-align:right;\"> 234.2 </td>\n   <td style=\"text-align:right;\"> 12843838 </td>\n   <td style=\"text-align:right;\"> 252987.71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2016 </td>\n   <td style=\"text-align:right;\"> 8804411 </td>\n   <td style=\"text-align:right;\"> 7491934113 </td>\n   <td style=\"text-align:right;\"> 2140443306 </td>\n   <td style=\"text-align:right;\"> 1113046.0 </td>\n   <td style=\"text-align:right;\"> 1283 </td>\n   <td style=\"text-align:right;\"> 262291.1 </td>\n   <td style=\"text-align:right;\"> 381007.8 </td>\n   <td style=\"text-align:right;\"> 31890 </td>\n   <td style=\"text-align:right;\"> 23787400 </td>\n   <td style=\"text-align:right;\"> 24431931 </td>\n   <td style=\"text-align:right;\"> 21113.70 </td>\n   <td style=\"text-align:right;\"> 8782.5 </td>\n   <td style=\"text-align:right;\"> 233.6 </td>\n   <td style=\"text-align:right;\"> 12524188 </td>\n   <td style=\"text-align:right;\"> 245262.83 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2017 </td>\n   <td style=\"text-align:right;\"> 10035803 </td>\n   <td style=\"text-align:right;\"> 7578157615 </td>\n   <td style=\"text-align:right;\"> 2248870724 </td>\n   <td style=\"text-align:right;\"> 1210921.9 </td>\n   <td style=\"text-align:right;\"> 1299 </td>\n   <td style=\"text-align:right;\"> 275852.4 </td>\n   <td style=\"text-align:right;\"> 384357.0 </td>\n   <td style=\"text-align:right;\"> 43224 </td>\n   <td style=\"text-align:right;\"> 23982000 </td>\n   <td style=\"text-align:right;\"> 26996263 </td>\n   <td style=\"text-align:right;\"> 23185.60 </td>\n   <td style=\"text-align:right;\"> 16311.9 </td>\n   <td style=\"text-align:right;\"> 237.7 </td>\n   <td style=\"text-align:right;\"> 13379452 </td>\n   <td style=\"text-align:right;\"> 266088.51 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018 </td>\n   <td style=\"text-align:right;\"> 10557976 </td>\n   <td style=\"text-align:right;\"> 7661776338 </td>\n   <td style=\"text-align:right;\"> 2339399881 </td>\n   <td style=\"text-align:right;\"> 1321908.5 </td>\n   <td style=\"text-align:right;\"> 1314 </td>\n   <td style=\"text-align:right;\"> 303526.2 </td>\n   <td style=\"text-align:right;\"> 465581.0 </td>\n   <td style=\"text-align:right;\"> 52401 </td>\n   <td style=\"text-align:right;\"> 27608500 </td>\n   <td style=\"text-align:right;\"> 30117721 </td>\n   <td style=\"text-align:right;\"> 23721.82 </td>\n   <td style=\"text-align:right;\"> 17657.0 </td>\n   <td style=\"text-align:right;\"> 236.7 </td>\n   <td style=\"text-align:right;\"> 14292672 </td>\n   <td style=\"text-align:right;\"> 242375.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2019 </td>\n   <td style=\"text-align:right;\"> 10930355 </td>\n   <td style=\"text-align:right;\"> 7742681934 </td>\n   <td style=\"text-align:right;\"> 2403074088 </td>\n   <td style=\"text-align:right;\"> 1445436.2 </td>\n   <td style=\"text-align:right;\"> 1327 </td>\n   <td style=\"text-align:right;\"> 330078.1 </td>\n   <td style=\"text-align:right;\"> 514078.4 </td>\n   <td style=\"text-align:right;\"> 30095 </td>\n   <td style=\"text-align:right;\"> 28558815 </td>\n   <td style=\"text-align:right;\"> 31630713 </td>\n   <td style=\"text-align:right;\"> 26263.08 </td>\n   <td style=\"text-align:right;\"> 20906.2 </td>\n   <td style=\"text-align:right;\"> 241.1 </td>\n   <td style=\"text-align:right;\"> 15760664 </td>\n   <td style=\"text-align:right;\"> 267275.83 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n# Elementary Analysis\n\n## Time Series\n\nAs the observations are over time, we observe the general trend in the variables through time series plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplots = lapply(colnames(d)[2:ncol(d)], function(.x) ggplot(d, aes(year, as.numeric(unlist(d[.x]))))+\n                 geom_line()+labs(y=.x)+mytheme+\n                 theme(axis.title.x = element_blank())\n               )\nrequire(gridExtra)\ngrid.arrange(grobs = plots, ncol = 3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nAs we can see, most covariates including `indfortour` tend to increase with time.\n\n## Box Plots\n\nWe try to detect outliers through box plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplots = lapply(colnames(d)[2:ncol(d)], function(.x) ggplot(d, aes(year, as.numeric(unlist(d[.x]))))+\n                 geom_boxplot(fill=\"#ffffff40\")+coord_flip()+labs(y=.x)+mytheme+\n                 theme(axis.text.y=element_blank(),\n                       axis.title.y = element_blank(),\n                       axis.text.x = element_blank())\n               )\nrequire(gridExtra)\ngrid.arrange(grobs=plots, ncol = 3)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThere is only one potential outlier in `indtourexp`. But previous time series plot shows it is not an anomaly.\n\n## Correlation\n\nComputed correlations and partial correlations with respect to `indfortour`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npcorr = c()\ncorr = c()\nfor (x in c(3:ncol(d))) {\n  v = c(3:ncol(d))\n  v = v[! v %in% c(x)]\n  pcorr = append(pcorr, partial.r(d, c(2,x) , v )[1,2] )\n  corr = append(corr, cor(d[,2], d[,x]) )\n}\n\ncorrtable = data.frame(\n  row.names = \"Variable\",\n  Variable = colnames(d)[3:ncol(d)],\n  correl = corr,\n  partcorr = pcorr\n)\nkable(\n  corrtable,\n  col.names = c(\n    \"Correlation\",\n    \"Partial Correlation\"\n  )\n)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Correlation </th>\n   <th style=\"text-align:right;\"> Partial Correlation </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> intpop </td>\n   <td style=\"text-align:right;\"> 0.9859420 </td>\n   <td style=\"text-align:right;\"> 0.5073311 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> intfortour </td>\n   <td style=\"text-align:right;\"> 0.9927588 </td>\n   <td style=\"text-align:right;\"> 0.7349934 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> hotelrev </td>\n   <td style=\"text-align:right;\"> 0.9926960 </td>\n   <td style=\"text-align:right;\"> 0.0968559 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indpop </td>\n   <td style=\"text-align:right;\"> 0.9815706 </td>\n   <td style=\"text-align:right;\"> -0.3146587 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indexport </td>\n   <td style=\"text-align:right;\"> 0.9118314 </td>\n   <td style=\"text-align:right;\"> 0.5312616 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indimport </td>\n   <td style=\"text-align:right;\"> 0.8928863 </td>\n   <td style=\"text-align:right;\"> -0.6215878 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indforinv </td>\n   <td style=\"text-align:right;\"> 0.6969831 </td>\n   <td style=\"text-align:right;\"> 0.1700049 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indforres </td>\n   <td style=\"text-align:right;\"> 0.9910628 </td>\n   <td style=\"text-align:right;\"> -0.3355004 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indpastra </td>\n   <td style=\"text-align:right;\"> 0.9955932 </td>\n   <td style=\"text-align:right;\"> 0.6821046 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> stattourexp </td>\n   <td style=\"text-align:right;\"> 0.9776340 </td>\n   <td style=\"text-align:right;\"> 0.2881789 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indtourexp </td>\n   <td style=\"text-align:right;\"> 0.9120386 </td>\n   <td style=\"text-align:right;\"> 0.2853752 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> indcrim </td>\n   <td style=\"text-align:right;\"> 0.9409528 </td>\n   <td style=\"text-align:right;\"> 0.1842352 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> inddep </td>\n   <td style=\"text-align:right;\"> 0.9856463 </td>\n   <td style=\"text-align:right;\"> -0.5989536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> forbankprof </td>\n   <td style=\"text-align:right;\"> 0.9402061 </td>\n   <td style=\"text-align:right;\"> -0.5676603 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**Correlation Matrix**\n\n::: column-screen-inset\n\n::: {.cell R.options='{\"width\":200}'}\n\n```{.r .cell-code}\ncor(d)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 year indfortour    intpop intfortour  hotelrev    indpop indexport indimport indforinv indforres indpastra stattourexp indtourexp   indcrim    inddep forbankprof\nyear        1.0000000  0.9845696 0.9999087  0.9834454 0.9792756 0.9991224 0.9528133 0.9378670 0.7401516 0.9875388 0.9854118   0.9630997  0.8899158 0.9268277 0.9885726   0.9686062\nindfortour  0.9845696  1.0000000 0.9859420  0.9927588 0.9926960 0.9815706 0.9118314 0.8928863 0.6969831 0.9910628 0.9955932   0.9776340  0.9120386 0.9409528 0.9856463   0.9402061\nintpop      0.9999087  0.9859420 1.0000000  0.9839476 0.9802495 0.9991834 0.9515490 0.9359304 0.7383361 0.9887937 0.9867042   0.9665202  0.8882334 0.9311207 0.9895588   0.9683597\nintfortour  0.9834454  0.9927588 0.9839476  1.0000000 0.9873411 0.9811150 0.9195015 0.9048397 0.7109258 0.9835434 0.9879517   0.9627482  0.9122705 0.9254252 0.9820989   0.9402730\nhotelrev    0.9792756  0.9926960 0.9802495  0.9873411 1.0000000 0.9755694 0.9080370 0.8960069 0.6725237 0.9880833 0.9935675   0.9657596  0.9306003 0.9181263 0.9809357   0.9305096\nindpop      0.9991224  0.9815706 0.9991834  0.9811150 0.9755694 1.0000000 0.9573082 0.9417886 0.7414410 0.9847639 0.9827566   0.9650981  0.8770030 0.9311448 0.9886827   0.9679262\nindexport   0.9528133  0.9118314 0.9515490  0.9195015 0.9080370 0.9573082 1.0000000 0.9943942 0.7653203 0.9189625 0.9288788   0.8976107  0.8060634 0.8922261 0.9483567   0.9533926\nindimport   0.9378670  0.8928863 0.9359304  0.9048397 0.8960069 0.9417886 0.9943942 1.0000000 0.7578143 0.9022249 0.9148673   0.8717561  0.8095449 0.8615457 0.9293601   0.9424746\nindforinv   0.7401516  0.6969831 0.7383361  0.7109258 0.6725237 0.7414410 0.7653203 0.7578143 1.0000000 0.7118332 0.7060397   0.6785585  0.5993293 0.6859846 0.7409505   0.7352888\nindforres   0.9875388  0.9910628 0.9887937  0.9835434 0.9880833 0.9847639 0.9189625 0.9022249 0.7118332 1.0000000 0.9926676   0.9789349  0.8949415 0.9431069 0.9813113   0.9599994\nindpastra   0.9854118  0.9955932 0.9867042  0.9879517 0.9935675 0.9827566 0.9288788 0.9148673 0.7060397 0.9926676 1.0000000   0.9779379  0.9089153 0.9455448 0.9890865   0.9510034\nstattourexp 0.9630997  0.9776340 0.9665202  0.9627482 0.9657596 0.9650981 0.8976107 0.8717561 0.6785585 0.9789349 0.9779379   1.0000000  0.8335011 0.9794994 0.9758391   0.9338204\nindtourexp  0.8899158  0.9120386 0.8882334  0.9122705 0.9306003 0.8770030 0.8060634 0.8095449 0.5993293 0.8949415 0.9089153   0.8335011  1.0000000 0.7460892 0.8774698   0.8381739\nindcrim     0.9268277  0.9409528 0.9311207  0.9254252 0.9181263 0.9311448 0.8922261 0.8615457 0.6859846 0.9431069 0.9455448   0.9794994  0.7460892 1.0000000 0.9481170   0.9212193\ninddep      0.9885726  0.9856463 0.9895588  0.9820989 0.9809357 0.9886827 0.9483567 0.9293601 0.7409505 0.9813113 0.9890865   0.9758391  0.8774698 0.9481170 1.0000000   0.9462154\nforbankprof 0.9686062  0.9402061 0.9683597  0.9402730 0.9305096 0.9679262 0.9533926 0.9424746 0.7352888 0.9599994 0.9510034   0.9338204  0.8381739 0.9212193 0.9462154   1.0000000\n```\n:::\n:::\n\n:::\n\n-   As we can clearly see almost all of the factors are correlated with each other. Thus, are originally assumption that they must be mutually independent is wrong.\n-   The response variable indfortour is significantly related to all predictor variables which means there are some latent relation within the predictors variables.\n-   Computing Partial Correlation Matrix throws singular matrix error.\n\n# Multiple Linear Regression\n\n## Ordinary Least Squares Model\n\nInitial Model using all the predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 = lm(indfortour~intpop+intfortour+hotelrev+\n              indpop+indexport+indimport+indforinv+indpastra+\n              stattourexp+indtourexp+indcrim+inddep+forbankprof,\n            d)\nsummary(model1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = indfortour ~ intpop + intfortour + hotelrev + indpop + \n    indexport + indimport + indforinv + indpastra + stattourexp + \n    indtourexp + indcrim + inddep + forbankprof, data = d)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-182841  -48171   -6602   52282  151519 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)  \n(Intercept) -2.039e+07  8.547e+06  -2.386   0.0544 .\nintpop       4.056e-03  3.724e-03   1.089   0.3179  \nintfortour   2.174e-03  9.116e-04   2.384   0.0544 .\nhotelrev    -5.486e-01  1.713e+00  -0.320   0.7596  \nindpop      -7.266e+03  1.735e+04  -0.419   0.6899  \nindexport    7.726e+00  6.200e+00   1.246   0.2592  \nindimport   -5.014e+00  3.026e+00  -1.657   0.1487  \nindforinv   -1.807e-01  3.380e+00  -0.053   0.9591  \nindpastra    1.675e-01  8.354e-02   2.005   0.0918 .\nstattourexp  1.564e+01  5.681e+01   0.275   0.7923  \nindtourexp   5.544e+01  4.078e+01   1.360   0.2228  \nindcrim      1.275e+04  1.465e+04   0.871   0.4174  \ninddep      -2.022e-01  1.323e-01  -1.528   0.1773  \nforbankprof -5.789e+00  2.844e+00  -2.035   0.0880 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 155800 on 6 degrees of freedom\nMultiple R-squared:  0.999,\tAdjusted R-squared:  0.9967 \nF-statistic: 442.6 on 13 and 6 DF,  p-value: 7.774e-08\n```\n:::\n:::\n\n\n-   There are no significant covariates.\n-   Six coefficients are negative along with the intercept, and seven coefficients are positive.\n-   The model is not statistically significant\n\n### Model Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np0 <- d %>%\n  ggplot(aes(x = year)) +\n  geom_line(aes(y = indfortour, color = \"Original\"), size = 1) +\n  geom_line(aes(y = predict(model1), color = \"Fitted\"), size = 1) +\n  scale_colour_manual(\"\", \n                      breaks = c(\"Original\", \"Fitted\"),\n                      values = c(\"#cc241d\", \"#689d6a\")) +\n  mytheme +\n  labs(subtitle = \"Time series\", color=\"Prediction\")\np0\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n## Predictor Selection\n\nWe exhaustively fit all subsets of the predictors, and use the model with highest adjusted R² for each subset size.\n\n::: column-screen-inset-right\n\n::: {.cell R.options='{\"width\":200}'}\n\n```{.r .cell-code}\nsubsetfit = regsubsets(indfortour~., data=d[2:ncol(d)], method=\"exhaustive\", nvmax = NULL)\nsummary_subsetfit = summary(subsetfit)\nsummary_subsetfit$which\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   (Intercept) intpop intfortour hotelrev indpop indexport indimport indforinv indforres indpastra stattourexp indtourexp indcrim inddep forbankprof\n1         TRUE  FALSE      FALSE    FALSE  FALSE     FALSE     FALSE     FALSE     FALSE      TRUE       FALSE      FALSE   FALSE  FALSE       FALSE\n2         TRUE  FALSE       TRUE    FALSE  FALSE     FALSE     FALSE     FALSE     FALSE      TRUE       FALSE      FALSE   FALSE  FALSE       FALSE\n3         TRUE  FALSE       TRUE    FALSE  FALSE     FALSE      TRUE     FALSE     FALSE      TRUE       FALSE      FALSE   FALSE  FALSE       FALSE\n4         TRUE   TRUE       TRUE    FALSE  FALSE     FALSE      TRUE     FALSE     FALSE      TRUE       FALSE      FALSE   FALSE  FALSE       FALSE\n5         TRUE   TRUE       TRUE    FALSE  FALSE      TRUE      TRUE     FALSE     FALSE      TRUE       FALSE      FALSE   FALSE  FALSE       FALSE\n6         TRUE  FALSE       TRUE    FALSE   TRUE      TRUE      TRUE     FALSE     FALSE      TRUE       FALSE       TRUE   FALSE  FALSE       FALSE\n7         TRUE   TRUE       TRUE    FALSE  FALSE      TRUE      TRUE     FALSE     FALSE      TRUE       FALSE      FALSE   FALSE   TRUE        TRUE\n8         TRUE   TRUE       TRUE    FALSE  FALSE     FALSE      TRUE     FALSE     FALSE      TRUE       FALSE       TRUE    TRUE   TRUE        TRUE\n9         TRUE   TRUE       TRUE    FALSE  FALSE      TRUE      TRUE     FALSE     FALSE      TRUE       FALSE       TRUE    TRUE   TRUE        TRUE\n10        TRUE   TRUE       TRUE    FALSE  FALSE      TRUE      TRUE     FALSE      TRUE      TRUE       FALSE       TRUE    TRUE   TRUE        TRUE\n11        TRUE   TRUE       TRUE    FALSE   TRUE      TRUE      TRUE     FALSE      TRUE      TRUE       FALSE       TRUE    TRUE   TRUE        TRUE\n12        TRUE   TRUE       TRUE    FALSE   TRUE      TRUE      TRUE     FALSE      TRUE      TRUE        TRUE       TRUE    TRUE   TRUE        TRUE\n13        TRUE   TRUE       TRUE    FALSE   TRUE      TRUE      TRUE      TRUE      TRUE      TRUE        TRUE       TRUE    TRUE   TRUE        TRUE\n14        TRUE   TRUE       TRUE     TRUE   TRUE      TRUE      TRUE      TRUE      TRUE      TRUE        TRUE       TRUE    TRUE   TRUE        TRUE\n```\n:::\n\n```{.r .cell-code}\nbest_subsetsize = which.max(summary_subsetfit$adjr2)\n```\n:::\n\n:::\n\n## Selected Model with highest adjusted R²\n\nWe find that highest adjusted R² is attained using 9 predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2 <- lm(indfortour~intpop+intfortour+indexport+indimport+\n               indpastra+indtourexp+indcrim+inddep+forbankprof,\n             d)\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = indfortour ~ intpop + intfortour + indexport + indimport + \n    indpastra + indtourexp + indcrim + inddep + forbankprof, \n    data = d)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-212002  -44342    7828   58392  140355 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)   \n(Intercept) -1.838e+07  4.993e+06  -3.681  0.00424 **\nintpop       2.476e-03  7.607e-04   3.255  0.00865 **\nintfortour   1.967e-03  6.276e-04   3.133  0.01063 * \nindexport    7.394e+00  4.331e+00   1.707  0.11860   \nindimport   -5.243e+00  2.297e+00  -2.282  0.04563 * \nindpastra    1.611e-01  5.208e-02   3.093  0.01138 * \nindtourexp   5.928e+01  2.779e+01   2.133  0.05868 . \nindcrim      1.551e+04  7.577e+03   2.047  0.06784 . \ninddep      -1.892e-01  9.298e-02  -2.035  0.06919 . \nforbankprof -5.159e+00  2.060e+00  -2.504  0.03123 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 123800 on 10 degrees of freedom\nMultiple R-squared:  0.9989,\tAdjusted R-squared:  0.9979 \nF-statistic:  1013 on 9 and 10 DF,  p-value: 1.345e-13\n```\n:::\n:::\n\n\n-   The model has five significant variables, and 4 non-significant variables.\n\n**Correlation Matrix**\n\n::: column-screen-inset-right\n\n::: {.cell R.options='{\"width\":200}'}\n\n```{.r .cell-code}\ncor(d[,c(\"indfortour\", \"intpop\", \"intfortour\", \"indexport\", \"indimport\",\n          \"indpastra\", \"indtourexp\", \"indcrim\", \"inddep\", \"forbankprof\")])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            indfortour    intpop intfortour indexport indimport indpastra indtourexp   indcrim    inddep forbankprof\nindfortour   1.0000000 0.9859420  0.9927588 0.9118314 0.8928863 0.9955932  0.9120386 0.9409528 0.9856463   0.9402061\nintpop       0.9859420 1.0000000  0.9839476 0.9515490 0.9359304 0.9867042  0.8882334 0.9311207 0.9895588   0.9683597\nintfortour   0.9927588 0.9839476  1.0000000 0.9195015 0.9048397 0.9879517  0.9122705 0.9254252 0.9820989   0.9402730\nindexport    0.9118314 0.9515490  0.9195015 1.0000000 0.9943942 0.9288788  0.8060634 0.8922261 0.9483567   0.9533926\nindimport    0.8928863 0.9359304  0.9048397 0.9943942 1.0000000 0.9148673  0.8095449 0.8615457 0.9293601   0.9424746\nindpastra    0.9955932 0.9867042  0.9879517 0.9288788 0.9148673 1.0000000  0.9089153 0.9455448 0.9890865   0.9510034\nindtourexp   0.9120386 0.8882334  0.9122705 0.8060634 0.8095449 0.9089153  1.0000000 0.7460892 0.8774698   0.8381739\nindcrim      0.9409528 0.9311207  0.9254252 0.8922261 0.8615457 0.9455448  0.7460892 1.0000000 0.9481170   0.9212193\ninddep       0.9856463 0.9895588  0.9820989 0.9483567 0.9293601 0.9890865  0.8774698 0.9481170 1.0000000   0.9462154\nforbankprof  0.9402061 0.9683597  0.9402730 0.9533926 0.9424746 0.9510034  0.8381739 0.9212193 0.9462154   1.0000000\n```\n:::\n:::\n\n:::\n\n-   Computing Partial Correlation Matrix throws singular matrix error.\n\n### Model Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- d %>%\n  ggplot(aes(x = year)) +\n  geom_line(aes(y = indfortour, color = \"Original\"), size = 1) +\n  geom_line(aes(y = predict(model2), color = \"Fitted\"), size = 1) +\n  scale_colour_manual(\"\", \n                      breaks = c(\"Original\", \"Fitted\"),\n                      values = c(\"#cc241d\", \"#689d6a\")) +\n  mytheme +\n  labs(subtitle = \"Time series\", color=\"Prediction\")\np1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## Selected Model with best p-value\n\nWe find that best p-value significance is attained using 4 predictors.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel3 <- lm(indfortour~intpop+intfortour+indimport+indpastra,\n             d)\nsummary(model3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = indfortour ~ intpop + intfortour + indimport + indpastra, \n    data = d)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-250619  -84196    3056   91404  225989 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -9.430e+06  2.960e+06  -3.186 0.006141 ** \nintpop       1.260e-03  5.316e-04   2.370 0.031643 *  \nintfortour   2.334e-03  6.890e-04   3.387 0.004066 ** \nindimport   -2.504e+00  5.778e-01  -4.333 0.000591 ***\nindpastra    2.003e-01  3.103e-02   6.456 1.08e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 148000 on 15 degrees of freedom\nMultiple R-squared:  0.9977,\tAdjusted R-squared:  0.997 \nF-statistic:  1592 on 4 and 15 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n-   All the predictors are significant in the model.\n-   The R² value is very high using a small subset of the predictors.\n\n**Correlation Matrix**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(d[,c(\"indfortour\", \"intpop\", \"intfortour\", \"indimport\",\n          \"indpastra\")])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           indfortour    intpop intfortour indimport indpastra\nindfortour  1.0000000 0.9859420  0.9927588 0.8928863 0.9955932\nintpop      0.9859420 1.0000000  0.9839476 0.9359304 0.9867042\nintfortour  0.9927588 0.9839476  1.0000000 0.9048397 0.9879517\nindimport   0.8928863 0.9359304  0.9048397 1.0000000 0.9148673\nindpastra   0.9955932 0.9867042  0.9879517 0.9148673 1.0000000\n```\n:::\n:::\n\n\n**Partial Correlation Matrix**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npcor(d[,c(\"indfortour\", \"intpop\", \"intfortour\", \"indimport\",\n          \"indpastra\")])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$estimate\n           indfortour      intpop  intfortour  indimport  indpastra\nindfortour  1.0000000  0.52190757  0.65828074 -0.7455799  0.8575415\nintpop      0.5219076  1.00000000 -0.07920208  0.6945475 -0.2517725\nintfortour  0.6582807 -0.07920208  1.00000000  0.3859728 -0.3414137\nindimport  -0.7455799  0.69454749  0.38597285  1.0000000  0.6393728\nindpastra   0.8575415 -0.25177252 -0.34141372  0.6393728  1.0000000\n\n$p.value\n             indfortour      intpop  intfortour    indimport    indpastra\nindfortour 0.000000e+00 0.031642971 0.004066218 0.0005911881 1.082203e-05\nintpop     3.164297e-02 0.000000000 0.762530572 0.0019751471 3.296398e-01\nintfortour 4.066218e-03 0.762530572 0.000000000 0.1259667167 1.798611e-01\nindimport  5.911881e-04 0.001975147 0.125966717 0.0000000000 5.717951e-03\nindpastra  1.082203e-05 0.329639772 0.179861132 0.0057179510 0.000000e+00\n\n$statistic\n           indfortour    intpop intfortour indimport indpastra\nindfortour   0.000000  2.369677   3.386827 -4.333055  6.456354\nintpop       2.369677  0.000000  -0.307715  3.738943 -1.007568\nintfortour   3.386827 -0.307715   0.000000  1.620434 -1.406821\nindimport   -4.333055  3.738943   1.620434  0.000000  3.220562\nindpastra    6.456354 -1.007568  -1.406821  3.220562  0.000000\n\n$n\n[1] 20\n\n$gp\n[1] 3\n\n$method\n[1] \"pearson\"\n```\n:::\n:::\n\n\n### Model Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\np2 <- d %>%\n  ggplot(aes(x = year)) +\n  geom_line(aes(y = indfortour, color = \"Original\"), size = 1) +\n  geom_line(aes(y = predict(model3), color = \"Fitted\"), size = 1) +\n  scale_colour_manual(\"\", \n                      breaks = c(\"Original\", \"Fitted\"),\n                      values = c(\"#cc241d\", \"#689d6a\")) +\n  mytheme +\n  labs(subtitle = \"Time series\", color=\"Prediction\")\np2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n## Quantile Regression Model\n\nWe use 5 selected predictors for the quantile regression model for the median.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel4 = rq(indfortour~indexport+indpop+indtourexp+indcrim+indimport,\n            tau = 0.5, data = d)\nmodel4\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\nrq(formula = indfortour ~ indexport + indpop + indtourexp + indcrim + \n    indimport, tau = 0.5, data = d)\n\nCoefficients:\n  (Intercept)     indexport        indpop    indtourexp       indcrim \n-1.860771e+07 -2.055811e+00  1.569840e+04  1.483933e+02  2.960738e+04 \n    indimport \n-1.664753e+00 \n\nDegrees of freedom: 20 total; 14 residual\n```\n:::\n:::\n\n\n# Simulation\n\nWe want to test our models in the situation that two predictors are absent - indtourexp and indcrim as these are very important variables, but difficult to accurately measure.\n\nModel 1 is the model involving all predictors. Model 2 is the model with highest adjusted R².\n\n::: column-page-inset\n\n::: {.cell}\n\n```{.r .cell-code}\ndata = read.csv(file.path(\".\",\"data\",\"tourist_data_simulation_purpose.csv\"), colClasses = \"numeric\", fileEncoding = 'UTF-8-BOM')\n\nsimulateindfortour = function(n) {\n  r = 1000\n  res = c(data[n,1], data[n,2], NA, NA, NA,NA)\n  \n  #using model1\n  \n  newdata <- data.frame(data[n,3:16])\n  indfortour <- predict(model1, newdata)\n  res[3] = mean(indfortour) #predicted value using model1\n  indtourexpsim <- recdf(data$indtourexp, r)\n  indcrimsim <- recdf(data$indcrim, r)\n\n  for (i in 1:r) \n  {\n    newrow <- c (data[n,3],data[n,4],data[n,5],data[n,6],data[n,7],data[n,8],data[n,9],data[n,10],data[n,11],data[n,12],indtourexpsim[i],indcrimsim[i],data[n,15],data[n,16])\n    newdata <- rbind(newdata, newrow)\n  }\n\n  newdata <- newdata[-1,]\n  indfortour <- predict(model1, newdata)\n  res[4] = mean(indfortour)#predicted value using model1 with missing predictors\n  \n  #using model2\n  \n  newdata <- data.frame(data[n,3:16])\n  indfortour <- predict(model2, newdata)\n  res[5] = mean(indfortour) #predicted value using model2\n  indtourexpsim <- recdf(data$indtourexp, r)\n  indcrimsim <- recdf(data$indcrim, r)\n  \n  for (i in 1:r) \n  {\n    newrow <- c (data[n,3],data[n,4],data[n,5],data[n,6],data[n,7],data[n,8],data[n,9],data[n,10],data[n,11],data[n,12],indtourexpsim[i],indcrimsim[i],data[n,15],data[n,16])\n    newdata <- rbind(newdata, newrow)\n  }\n  \n  indfortour <- predict(model2, newdata)\n  res[6] = mean(indfortour)#predicted value using model2 with missing predictors\n  return(res)\n}\n\nr = 1000\n\n# data point1\n\nsimtable = simulateindfortour(1)\n\n# data point2\n  \nsimtable = rbind(simtable, simulateindfortour(2))\n\n# data point3\n  \nsimtable = rbind(simtable, simulateindfortour(7))\n\n# data point4\n\nsimtable = rbind(simtable, simulateindfortour(15))\n\nsimtable = data.frame(simtable)\nrow.names(simtable) <- NULL\n\nsimtable %>%\n    kable(\"html\", col.names = c(\n    \"Year\",\n    \"Original Value\",\n    \"Model 1 prediction\",\n    \"Model 1 prediction after simulation\",\n    \"Model 2 prediction\",\n    \"Model 2 prediction after simulation\"\n    )\n  ) %>% column_spec(1:6, width = \"6cm\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Year </th>\n   <th style=\"text-align:right;\"> Original Value </th>\n   <th style=\"text-align:right;\"> Model 1 prediction </th>\n   <th style=\"text-align:right;\"> Model 1 prediction after simulation </th>\n   <th style=\"text-align:right;\"> Model 2 prediction </th>\n   <th style=\"text-align:right;\"> Model 2 prediction after simulation </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;width: 6cm; \"> 2000 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 2638813 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 2520774 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 3270848 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 2498458 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 3372579 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;width: 6cm; \"> 2001 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 2537282 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 2550759 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 3370307 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 2546721 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 3467466 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;width: 6cm; \"> 2006 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 4447167 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 4500597 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 4973480 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 4487057 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 5095410 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;width: 6cm; \"> 2014 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 7679099 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 7810983 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 7458938 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 7802343 </td>\n   <td style=\"text-align:right;width: 6cm; \"> 7425494 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n:::\n\n# Conclusion\n\n-   We can see that in our model there are 14 covariates, of which 4 namely, `intpop`, `intfortour`, `indimport` and `indpastra` are most significant.\n-   There is dependance between the variables.\n-   The R² and adjusted R² are very high meaning our model fits `indfortour` well. They explain more than 99% of the variation in `indfortour`.\n-   If the data for `indtourexp` and `indcrim` are not available, our model using all the predictors is better than the model with highest adjusted R².\n-   Note that due to the nature of our analysis, we could not consider Tourists from Different Nations separately. Factors like relative GDP per Capita, Proximity between the Nations, and Flight Prices would certainly affect the amount of Tourists arriving from country to country.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}